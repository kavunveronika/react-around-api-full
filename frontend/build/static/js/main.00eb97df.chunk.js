(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{31:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n(1),i=n.n(o),r=n(19),c=n.n(r),s=(n(31),n(24)),l=n(4),u=n.p+"static/media/logo.4e8e0a1d.svg",p=n(3),d=n(7);var m=function(e){var t=Object(p.h)(),n={text:"",route:"",email:""};return n=function(){"/signup"===t.pathname?(n.text="Log in",n.route="/login",n.email=""):"/login"===t.pathname?(n.text="Sign up",n.route="/signup",n.email=""):(n.text="Log out",n.email=e.userEmail,n.route="/login");return n}(),Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("header",{className:"header",children:[Object(a.jsx)("img",{className:"header__logo",src:u,alt:"Around the US logo"}),Object(a.jsxs)("div",{className:"header__email",children:[n.email,Object(a.jsx)(d.b,{to:n.route,className:"header__link "+("/signup"===t.pathname||"/login"===t.pathname?"":"header__link_logged-in"),onClick:"/"===t.pathname?e.onSignOut:null,children:n.text})]})]})})};var j=function(){return Object(a.jsx)("footer",{children:Object(a.jsx)("p",{className:"footer__copyright",children:"\xa9 2020. Veronika Bowersock"})})},h=i.a.createContext();var f=function(e){var t=i.a.useContext(h),n=t&&e.card.owner===t._id,o="images__delete  ".concat(n?"":"images__delete_hidden"),r=0!==e.card.likes.length&&e.card.likes.some((function(e){return t&&e===t._id})),c="images__like-button  ".concat(r?"images__like-button_active":"");return Object(a.jsxs)("li",{className:"images__card",children:[Object(a.jsx)("div",{className:"images__picture",style:{backgroundImage:"url(".concat(e.card.link,")")},onClick:function(t){"button"!==t.target.localName&&e.onCardClick(e.card)},children:Object(a.jsx)("button",{className:o,"aria-label":"Delete image",onClick:function(){e.onCardDelete(e.card)}})}),Object(a.jsxs)("div",{className:"images__caption",children:[Object(a.jsx)("p",{className:"images__text",children:e.card.name}),Object(a.jsxs)("div",{className:"images__like",children:[Object(a.jsx)("button",{className:c,"aria-label":"Like image",onClick:function(){e.onCardLike(e.card)}}),Object(a.jsx)("span",{className:"images__like-count",children:e.card.likes.length})]})]})]})};var b=function(e){var t=i.a.useContext(h);return Object(a.jsxs)("main",{className:"main-content",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsx)("img",{className:"profile__image",src:t&&t.avatar,alt:"profile pic"}),Object(a.jsx)("div",{className:"profile__overlay",onClick:e.onEditAvatar,children:Object(a.jsx)("button",{className:"profile__overlay_button","aria-label":"change avatar"})}),Object(a.jsxs)("div",{className:"profile__description",children:[Object(a.jsxs)("div",{className:"profile__name",children:[Object(a.jsx)("h1",{className:"profile__text",children:t&&t.name}),Object(a.jsx)("button",{className:"profile__edit","aria-label":"Edit profile",onClick:e.onEditProfile})]}),Object(a.jsx)("p",{className:"profile__occupation",children:t&&t.about})]}),Object(a.jsx)("button",{className:"profile__add","aria-label":"Add image",onClick:e.onAddPlace})]}),Object(a.jsx)("section",{className:"images",children:Object(a.jsx)("ul",{className:"images__list",children:e.cards.map((function(t){return Object(a.jsx)(f,{card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})})]})};var _=function(e){return Object(a.jsx)("div",{className:"popup popup_image ".concat(e.card?"":"popup_hidden"),children:Object(a.jsxs)("div",{className:"popup__content popup__content_fullscreen",children:[Object(a.jsx)("button",{name:"close_button",className:"popup__close popup__close_image","aria-label":"Close popup",onClick:e.onClose}),Object(a.jsx)("img",{className:"images__picture images__picture_fullscreen",src:e.card?e.card.link:"",alt:e.card?e.card.name:""}),Object(a.jsx)("p",{className:"images__text images__text_fullscreen",children:e.card?e.card.name:""})]})})},g=n(21),O=n(22),v=new(function(){function e(t){Object(g.a)(this,e),this.url=t.baseUrl}return Object(O.a)(e,[{key:"getInitialCards",value:function(e){return fetch(this.url+"/cards",{headers:{authorization:"Bearer "+e}}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"getUserInfo",value:function(e){return fetch(this.url+"/users/me",{headers:{authorization:"Bearer "+e}}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"updateUserInfo",value:function(e,t){return fetch(this.url+"/users/me",{method:"PATCH",headers:{authorization:"Bearer "+t,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"postNewCard",value:function(e,t){return fetch(this.url+"/cards",{method:"POST",headers:{authorization:"Bearer "+t,"Content-Type":"application/json"},body:JSON.stringify({name:e.title,link:e.url})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"deleteCard",value:function(e,t){return fetch(this.url+"/cards/"+e,{method:"DELETE",headers:{authorization:"Bearer "+t,"Content-Type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"addLike",value:function(e,t,n){var a=t?"DELETE":"PUT";return fetch(this.url+"/cards/"+e+"/likes",{method:a,headers:{authorization:"Bearer "+n}}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"updateAvatar",value:function(e,t){return fetch(this.url+"/users/me/avatar",{method:"PATCH",headers:{authorization:"Bearer "+t,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}}]),e}())({baseUrl:"api.vbowe.students.nomoreparties.site"});var x=function(e){var t=e.isOpen?"":"popup_hidden",n=e.overlay?"popup":"",o=e.closeButton?"":"popup__close_hidden",i=e.titleCentered?"popup__title_centered":"";return Object(a.jsx)("div",{className:"".concat(n," popup_form popup_form-").concat(e.name," ").concat(t),children:Object(a.jsx)("div",{className:"popup__content",children:Object(a.jsxs)("form",{className:"popup__form popup__form_".concat(e.name),noValidate:!0,onSubmit:e.onSubmit,children:[Object(a.jsx)("button",{name:"close_button",className:"popup__close popup__close_form-".concat(e.name," ").concat(o),type:"reset","aria-label":"Close",onClick:e.onClose}),Object(a.jsx)("h2",{className:"popup__title ".concat(i),children:e.title}),e.children]})})})};var C=function(e){var t=i.a.useState(""),n=Object(l.a)(t,2),o=n[0],r=n[1],c=i.a.useState(""),s=Object(l.a)(c,2),u=s[0],p=s[1],d=i.a.useContext(h);return i.a.useEffect((function(){r(d&&d.name),p(d&&d.about)}),[d]),Object(a.jsxs)(x,{onClose:e.onClose,name:"edit",title:"Edit Profile",closeButton:!0,overlay:!0,titleCentered:!1,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:u})},children:[Object(a.jsx)("input",{type:"text",placeholder:"Name",id:"name-input",className:"popup__field popup__field_name",name:"name",value:o||"",required:!0,minLength:2,maxLength:40,onChange:function(e){r(e.target.value)}}),Object(a.jsx)("span",{className:"popup__input-error",id:"name-input-error"}),Object(a.jsx)("input",{type:"text",placeholder:"About",id:"about-input",className:"popup__field popup__field_about",name:"about",value:u||"",required:!0,minLength:2,maxLength:200,onChange:function(e){p(e.target.value)}}),Object(a.jsx)("span",{className:"popup__input-error",id:"about-input-error"}),Object(a.jsx)("input",{type:"submit",className:"popup__save","aria-label":"Save",defaultValue:"Save"})]})};var k=function(e){var t=i.a.useRef("");return Object(a.jsxs)(x,{onClose:e.onClose,name:"avatar",titleCentered:!1,overlay:!0,title:"Change profile picture",closeButton:!0,isOpen:e.isOpen,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t})},children:[Object(a.jsx)("input",{type:"url",placeholder:"Avatar Link",id:"link-input",name:"link",required:!0,className:"popup__field popup__field_link",ref:t}),Object(a.jsx)("span",{className:"popup__input-error",id:"link-input-error"}),Object(a.jsx)("input",{type:"submit",className:"popup__save","aria-label":"Save",defaultValue:"Save"})]})};var N=function(e){var t=i.a.useState(""),n=Object(l.a)(t,2),o=n[0],r=n[1],c=i.a.useState(""),s=Object(l.a)(c,2),u=s[0],p=s[1];return Object(a.jsxs)(x,{onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddCard({title:o,url:u}),p(""),r("")},titleCentered:!1,overlay:!0,closeButton:!0,name:"add",title:"New Place",isOpen:e.isOpen,children:[Object(a.jsx)("input",{type:"text",placeholder:"Title",id:"title-input",value:o,required:!0,minLength:1,maxLength:30,name:"name",className:"popup__field popup__field_title",onChange:function(e){r(e.target.value)}}),Object(a.jsx)("span",{className:"popup__input-error",id:"title-input-error"}),Object(a.jsx)("input",{type:"url",placeholder:"Image Link",id:"link-input",value:u,name:"link",required:!0,className:"popup__field popup__field_link",onChange:function(e){p(e.target.value)}}),Object(a.jsx)("span",{className:"popup__input-error",id:"link-input-error"}),Object(a.jsx)("input",{type:"submit",className:"popup__save","aria-label":"Save",defaultValue:"Save"})]})},y=n(25),S=n(23),w=function(e){var t=e.component,n=Object(S.a)(e,["component"]);return Object(a.jsx)(p.b,{children:function(){return n.loggedIn?Object(a.jsx)(t,Object(y.a)({},n)):Object(a.jsx)(p.a,{to:"./login"})}})};var E=function(e){return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)(x,{name:"login",title:"Log in",isOpen:!0,overlay:!1,titleCentered:!0,closeButton:!1,onClose:e.onClose,onSubmit:e.handleLoginSubmit,children:[Object(a.jsx)("input",{type:"text",placeholder:"Email",id:"email-input",className:"popup__field popup__field_login",name:"name",value:e.userEmail,required:!0,minLength:2,maxLength:40,onChange:function(t){e.setUserEmail(t.target.value)}}),Object(a.jsx)("input",{type:"password",placeholder:"Password",id:"password-input",className:"popup__field popup__field_login",name:"about",value:e.userPassword,required:!0,minLength:2,maxLength:200,onChange:function(t){e.setUserPassword(t.target.value)}}),Object(a.jsx)("input",{className:"popup__save popup__save_login","aria-label":"Log in",defaultValue:"Log in",onClick:e.onSubmit}),Object(a.jsx)(d.b,{className:"popup__link",to:"/signup",children:"Not a member yet? Sign up here!"})]})})};var L=function(e){return Object(a.jsxs)(x,{name:"login",title:"Sign Up",isOpen:!0,overlay:!1,titleCentered:!0,closeButton:!1,onClose:e.onClose,onSubmit:e.handleLoginSubmit,children:[Object(a.jsx)("input",{type:"text",placeholder:"Email",id:"email-input",className:"popup__field popup__field_login",name:"name",value:e.userEmail,required:!0,minLength:2,maxLength:40,onChange:function(t){e.setUserEmail(t.target.value)}}),Object(a.jsx)("input",{type:"password",placeholder:"Password",id:"password-input",className:"popup__field popup__field_login",name:"about",value:e.userPassword,required:!0,minLength:2,maxLength:200,onChange:function(t){e.setUserPassword(t.target.value)}}),Object(a.jsx)("input",{className:"popup__save popup__save_login","aria-label":"Sign Up",defaultValue:"Sign Up",onClick:e.onSubmit}),Object(a.jsx)(d.b,{className:"popup__link",to:"/login",children:"Already a member? Log in here!"})]})},P=n.p+"static/media/checkmark.1b6082f8.svg",U=n.p+"static/media/fail.df8eddf6.svg";var T=function(e){return Object(a.jsxs)(x,{name:"tooltip",isOpen:e.isOpen,onClose:e.onClose,closeButton:!0,overlay:!0,children:[Object(a.jsx)("img",{className:"popup__tooltip-icon",src:"success"===e.tooltipType?P:U,alt:"check mark"}),Object(a.jsx)("h2",{className:"popup__tooltip-message",children:"success"===e.tooltipType?"Success! You have now been registered":"Oops, something went wrong! Please try again."})]})},A="api.vbowe.students.nomoreparties.site";var B=Object(p.i)((function(){var e=i.a.useState(!1),t=Object(l.a)(e,2),n=t[0],o=t[1],r=i.a.useState(!1),c=Object(l.a)(r,2),u=c[0],d=c[1],f=i.a.useState(!1),g=Object(l.a)(f,2),O=g[0],x=g[1],y=i.a.useState(null),S=Object(l.a)(y,2),P=S[0],U=S[1],B=i.a.useState(null),I=Object(l.a)(B,2),D=I[0],q=I[1],z=i.a.useState([]),J=Object(l.a)(z,2),V=J[0],F=J[1],H=i.a.useState(!1),R=Object(l.a)(H,2),G=R[0],M=R[1],Y=i.a.useState(!1),K=Object(l.a)(Y,2),Q=K[0],W=K[1],X=i.a.useState(""),Z=Object(l.a)(X,2),$=Z[0],ee=Z[1],te=i.a.useState(""),ne=Object(l.a)(te,2),ae=ne[0],oe=ne[1],ie=i.a.useState(""),re=Object(l.a)(ie,2),ce=re[0],se=re[1],le=i.a.useState(!1),ue=Object(l.a)(le,2),pe=(ue[0],ue[1]),de=localStorage.getItem("jwt"),me=Object(p.g)({forceRefresh:!0});function je(){x(!1),o(!1),d(!1),U(null),W(!1)}function he(e){ee(e),W(!0)}function fe(){oe(""),se("")}return i.a.useEffect((function(){v.getInitialCards(de).then((function(e){e=Array.from(e),F(e)})).catch((function(e){console.log(e)}))}),[]),i.a.useEffect((function(){de?function(e){return fetch("".concat(A,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){return e}))}(de).then((function(e){M(!0),oe(e.email)})).then((function(){return me.push("/")})).catch((function(e){console.log(e)})):M(!1)}),[me]),i.a.useEffect((function(){v.getUserInfo(de).then((function(e){q(e)})).catch((function(e){console.log(e)}))}),[G]),Object(a.jsx)(h.Provider,{value:D,children:Object(a.jsxs)("div",{className:"page",children:[Object(a.jsx)(m,{userEmail:ae,loggedIn:G,onSignOut:function(){localStorage.removeItem("jwt"),M(!1),me.push("/login")}}),Object(a.jsxs)(p.d,{children:[Object(a.jsxs)(p.b,{exact:!0,path:"/login",children:[Object(a.jsx)(E,{userEmail:ae,setUserEmail:oe,userPassword:ce,setUserPassword:se,onSubmit:function(){var e,t;(e=ae,t=ce,fetch("".concat(A,"/login"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){if(e.token)return localStorage.setItem("jwt",e.token),e})).catch((function(e){return console.log(e)}))).then((function(e){if(!ae||!ce)throw he("fail"),fe(),new Error("400 - one or more of the fields were not provided");if(!e)throw he("fail"),fe(),new Error("401 - Email or password are incorrect")})).then((function(){M(!0)})).then((function(){me.push("/")})).catch((function(e){return console.log(e.message)}))}}),Object(a.jsx)(T,{isOpen:Q,onClose:je,tooltipType:$,loggedIn:G})]}),Object(a.jsxs)(p.b,{exact:!0,path:"/signup",children:[Object(a.jsx)(L,{userEmail:ae,setUserEmail:oe,userPassword:ce,setUserPassword:se,onSubmit:function(){var e,t;(e=ae,t=ce,fetch("".concat(A,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.log(e)}))).then((function(e){if(!e)throw he("fail"),fe(),new Error("400 - one of the fields was filled in incorrectly")})).then((function(e){return pe(!0),me.push("/login"),e})).then((function(e){return he("success"),e})).then(fe).catch((function(e){console.log(e)}))}}),Object(a.jsx)(T,{isOpen:Q,onClose:je,loggedIn:G,tooltipType:$})]}),Object(a.jsxs)(p.b,{path:"/",children:[Object(a.jsx)(C,{isOpen:n,onClose:je,onUpdateUser:function(e){var t=e.name,n=e.about;v.updateUserInfo({name:t,about:n},de).then((function(e){q(e)})).catch((function(e){console.log(e)})),je()}}),Object(a.jsx)(N,{isOpen:u,onClose:je,onAddCard:function(e){var t=e.title,n=e.url;v.postNewCard({title:t,url:n},de).then((function(e){F([e].concat(Object(s.a)(V)))})).catch((function(e){console.log(e)})),je()}}),Object(a.jsx)(k,{isOpen:O,onClose:je,onUpdateAvatar:function(e){var t=e.avatar;v.updateAvatar(t.current.value,de).then((function(e){q(e)})).catch((function(e){console.log(e)})),je()}}),Object(a.jsx)(_,{onClose:je,card:P}),Object(a.jsx)(w,{path:"/",loggedIn:G,component:b,onEditProfile:function(){o(!0)},onAddPlace:function(){d(!0)},onEditAvatar:function(){x(!0)},onCardClick:function(e){U(e)},cards:V,onCardDelete:function(e){v.deleteCard(e._id,de).then((function(){var t=V.filter((function(t){return t._id!==e._id}));F(t)})).catch((function(e){console.log(e)}))},onCardLike:function(e){var t=e.likes.some((function(e){return e===D._id}));v.addLike(e._id,t,de).then((function(t){var n=V.map((function(n){return n._id===e._id?t:n}));F(n)})).catch((function(e){console.log(e)}))}}),Object(a.jsx)(j,{})]})]})]})})})),I=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,38)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),o(e),i(e),r(e)}))};c.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(d.a,{children:Object(a.jsx)(B,{})})}),document.getElementById("root")),I()}},[[37,1,2]]]);
//# sourceMappingURL=main.00eb97df.chunk.js.map